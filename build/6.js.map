{"version":3,"sources":["../../src/pages/signup/signup.module.ts","../../src/pages/signup/signup.ts"],"names":[],"mappings":"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","file":"6.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { SignupPage } from './signup';\r\n\r\nimport { ComponentsModule } from '../../components/components.module';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    SignupPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(SignupPage),\r\n    ComponentsModule\r\n  ],\r\n})\r\nexport class SignupPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/signup/signup.module.ts","import { FirestoreProvider } from './../../providers/firestore/firestore';\r\nimport { Component } from '@angular/core';\r\nimport {\r\n  IonicPage,\r\n  NavController,\r\n  LoadingController,\r\n  Loading,\r\n  AlertController } from 'ionic-angular';\r\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\r\nimport { OtuAuthProvider } from '../../providers/otu-auth/otu-auth';\r\nimport { EmailValidator } from '../../validators/email';\r\nimport { UsernameValidator } from '../../validators/username';\r\n\r\nimport { ErrorPage } from '../error/error';\r\nimport { DynaPage } from '../dyna/dyna';\r\nimport { OtuConfigProvider } from '../../providers/otu-config/otu-config';\r\n\r\n/**\r\n * Generated class for the SignupPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-signup',\r\n  templateUrl: 'signup.html',\r\n})\r\nexport class SignupPage {\r\n\r\n  public signupForm: FormGroup;\r\n  public loading: Loading;\r\n  public roles = ['admin', 'am', 'sp', 'cust'];\r\n  myReference: any;\r\n  myRole: any;\r\n  refUser$: any;\r\n  appId;\r\n\r\n  constructor(\r\n                public nav: NavController\r\n              , public authData: OtuAuthProvider\r\n              , public formBuilder: FormBuilder\r\n              , public loadingCtrl: LoadingController\r\n              , public alertCtrl: AlertController\r\n              , private firestore: FirestoreProvider\r\n              , private refCheck: UsernameValidator\r\n              , private config: OtuConfigProvider\r\n              ) {\r\n\r\n    this.appId = this.config.getAppIdWithDetails();\r\n    if(this.appId.appId == 1) {\r\n      this.signupForm = formBuilder.group({\r\n        email: ['', Validators.compose([Validators.required, EmailValidator.isValid])],\r\n        password: ['', Validators.compose([Validators.minLength(6), Validators.required])],\r\n        reference: ['', Validators.compose([Validators.required, EmailValidator.isValid]), refCheck.checkReference.bind(refCheck)],\r\n        appliedFor: ['', Validators.compose([Validators.required])],\r\n      });\r\n    } else { \r\n      this.signupForm = formBuilder.group({\r\n        email: ['', Validators.compose([Validators.required, EmailValidator.isValid])],\r\n        password: ['', Validators.compose([Validators.minLength(6), Validators.required])]\r\n      });\r\n    }\r\n\r\n    // this.signupForm = formBuilder.group({\r\n    //   email: ['', Validators.compose([Validators.required, EmailValidator.isValid])],\r\n    //   password: ['', Validators.compose([Validators.minLength(6), Validators.required])],\r\n    //   reference: ['', Validators.compose([Validators.required, EmailValidator.isValid]), refCheck.checkReference.bind(refCheck)],\r\n    //   appliedFor: ['', Validators.compose([Validators.required])],\r\n    // });\r\n\r\n  }\r\n\r\n  /**\r\n   * If the form is valid it will call the AuthData service to sign the user up password displaying a loading\r\n   *  component while the user waits.\r\n   *\r\n   * If the form is invalid it will just log the form value, feel free to handle that as you like.\r\n   */\r\n  signupUser(){\r\n    if (!this.signupForm.valid){\r\n      console.log(this.signupForm.value);\r\n    } else {\r\n      console.log(this.signupForm.value);\r\n      this.firestore.getUser(this.signupForm.value.reference).valueChanges().subscribe((u) => {\r\n        if(u != undefined && u != null && u.length > 0) {\r\n//////From here //////\r\n          this.authData.signupUser(this.signupForm.value.email, this.signupForm.value.password)\r\n          .then((user) => {\r\n            // this.authData.updateProfile(\"Vidya Bhandary\", \"https://pbs.twimg.com/profile_images/1045303961681453057/M-UYoU7h_400x400.jpg\")\r\n            console.log(user);\r\n            console.log(user.user.email);\r\n            console.log(user.user.uid);\r\n            console.log(user.user.password);\r\n            console.log(`uid is ${user.user.uid}; email is ${this.signupForm.value.email}; ref is ${this.signupForm.value.reference} & applied is ${this.signupForm.value.appliedFor}`);\r\n\r\n            let applied;\r\n            let ref;\r\n            if(this.appId.appId == 1) {\r\n              applied = this.signupForm.value.reference;\r\n              ref = this.signupForm.value.appliedFor;\r\n            } else {\r\n              applied = this.appId.appliedFor;\r\n              ref = this.appId.ref;\r\n            }\r\n            this.firestore.addAppliedUser(  user.user.uid, this.signupForm.value.email, \r\n                                            applied, ref, \r\n                                            false, u[0]['id']).then(() => {\r\n              this.nav.setRoot(ErrorPage, {msg: \"Your request has been sent for approval. You'll be informed by email once it is approved.\"});  \r\n            }, (e) => {\r\n              console.log(`From Signup.ts`);\r\n              console.log(e);\r\n              this.nav.setRoot(ErrorPage, {error: e});\r\n            })\r\n          }, (error) => {\r\n            this.loading.dismiss().then( () => {\r\n              var errorMessage: string = error.message;\r\n                let alert = this.alertCtrl.create({\r\n                  message: errorMessage,\r\n                  buttons: [\r\n                    {\r\n                      text: \"Ok\",\r\n                      role: 'cancel'\r\n                    }\r\n                  ]\r\n                });\r\n              alert.present();\r\n            });\r\n          });\r\n\r\n          this.loading = this.loadingCtrl.create({\r\n            dismissOnPageChange: true,\r\n          });\r\n          this.loading.present();\r\n////// Till here /////          \r\n        } else {\r\n          this.nav.setRoot(ErrorPage, {msg: \"Your have provided an invalid reference. Please check with your reference and try again after some time.\"});            \r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/signup/signup.ts"],"sourceRoot":""}